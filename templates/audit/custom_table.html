<!-- templates/audit/custom_table.html -->

{% load django_tables2 %}

<table class="table-auto w-full">
    <thead>
        <tr>
            {% for column in table.columns %}
                <th {{ column.attrs.th.as_html }} class="px-4 py-2 {% if forloop.counter0 == 0 %}sticky-col-1{% endif %}">
                    {{ column.header }}
                </th>
            {% endfor %}
        </tr>
    </thead>              
    <tbody id="audit-table-body">
        {% for row in table.rows %}
            <tr class="border-b border-gray-700 hover:bg-gray-700">
                {% for column, cell in row.items %}
                    <td {{ column.attrs.td.as_html }} class="px-4 py-2 {% if forloop.counter0 == 0 %}sticky-col-1{% endif %}">
                        {{ cell|safe }}
                    </td>
                {% endfor %}
            </tr>
        {% endfor %}
    </tbody>    
</table>

<style>
    /* Ensure all table cells have nowrap and align properly */
    table th, table td {
        white-space: nowrap;
        text-align: left;
        padding-left: 1rem; /* Add padding to each cell */
        padding-right: 1rem; /* Add padding to each cell */
        border: none; /* Ensure there is no border around the cells */
    }

    /* Ensure no gaps between cells and collapse borders */
    table {
        border-collapse: collapse; /* This removes gaps between cells */
    }

    /* Style sticky columns and headers */
    .sticky-col-1, .sticky-col-2 {
        position: sticky;
        background-color: #2d3748; /* Keep sticky column background consistent */
        z-index: 3; /* Base z-index for body cells */
    }

    /* First column (Actions) */
    .sticky-col-1 {
        left: 0;
        width: 150px; /* Set width for the first column */
        z-index: 3; /* Higher z-index to stay above other sticky columns */
        background-color: #2d3748; /* Ensure consistent background */
    }

    /* Ensure headers for sticky columns are also sticky */
    th.sticky-col-1 {
        top: 0;
        z-index: 5; /* Highest z-index for headers */
        background-color: #2d3748; /* Ensure consistent header background */
    }

    /* Second column (URL) */
    .sticky-col-2 {
        left: 150px; /* Align right next to the first sticky column */
        width: 300px; /* Adjust the width of the second column if needed */
        z-index: 2; /* Lower z-index than the first sticky column */
    }

    /* Ensure headers for sticky columns are also sticky */
    th.sticky-col-2 {
        top: 0;
        left: 150px; /* Same left position as the body cells */
        z-index: 4; /* Lower than the first sticky header */
        background-color: #2d3748;
    }

    /* Page Path column (non-sticky) */
    .page-path {
        min-width: 200px; /* Set a minimum width to ensure no overlap */
        padding-left: 50px; /* Adds a gap between the URL and Page Path headers */
    }

    /* Adjust the Page Path header */
    th.page-path {
        padding-left: 50px; /* Add a gap between URL and Page Path headers */
    }

    /* Optional: Style for the action form dropdowns */
    .action-form form {
        display: flex;
        align-items: center;
    }

    .action-dropdown {
        width: 100%;
        background-color: #4a5568; /* Dark background */
        color: #fff; /* White text */
        border: none;
        border-radius: 4px;
        padding: 0.25rem;
    }

    /* Ensure the table container allows sticky positioning */
    .table-container {
        position: relative;
        overflow: auto;
    }
</style>
