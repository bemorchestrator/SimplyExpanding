{% extends 'base.html' %}

{% block content %}
<div class="mt-10 px-8">
    <div class="bg-white shadow-md rounded px-8 py-6">
        <h2 class="text-xl font-semibold mb-4">Website Audit Dashboard</h2>

        <div class="overflow-x-auto">
            <table class="min-w-full bg-white">
                <thead>
                    <tr class="text-gray-700 uppercase text-sm leading-normal">
                        <th class="py-1 px-2 text-left whitespace-nowrap">Actions</th>
                        <th class="py-1 px-2 text-left whitespace-nowrap">URL</th>
                        <th class="py-1 px-2 text-left whitespace-nowrap">Final URL</th>
                        <th class="py-1 px-2 text-left whitespace-nowrap">Page Path</th>
                        <th class="py-1 px-2 text-left whitespace-nowrap">Category</th>
                        <th class="py-1 px-2 text-left whitespace-nowrap">Page Depth</th>
                        <th class="py-1 px-2 text-left whitespace-nowrap">In Sitemap</th>

                        <!-- Keyword Performance -->
                        <th class="py-1 px-2 text-left whitespace-nowrap">Main KW</th>
                        <th class="py-1 px-2 text-left whitespace-nowrap">Volume</th>
                        <th class="py-1 px-2 text-left whitespace-nowrap">Ranking</th>
                        <th class="py-1 px-2 text-left whitespace-nowrap">Best KW</th>
                        <th class="py-1 px-2 text-left whitespace-nowrap">Volume</th>
                        <th class="py-1 px-2 text-left whitespace-nowrap">Ranking</th>

                        <!-- Page Performance -->
                        <th class="py-1 px-2 text-left whitespace-nowrap">Impressions</th>
                        <th class="py-1 px-2 text-left whitespace-nowrap">Sessions</th>
                        <th class="py-1 px-2 text-left whitespace-nowrap">% Change Sessions</th>
                        <th class="py-1 px-2 text-left whitespace-nowrap">Bounce Rate</th>
                        <th class="py-1 px-2 text-left whitespace-nowrap">Avg Time on Page</th>
                        <th class="py-1 px-2 text-left whitespace-nowrap">Losing Traffic?</th>
                        <th class="py-1 px-2 text-left whitespace-nowrap">Links</th>
                        <th class="py-1 px-2 text-left whitespace-nowrap">SERP CTR</th>

                        <!-- Screaming Frog On-Page -->
                        <th class="py-1 px-2 text-left whitespace-nowrap">Type</th>
                        <th class="py-1 px-2 text-left whitespace-nowrap">Current Title</th>
                        <th class="py-1 px-2 text-left whitespace-nowrap">Meta</th>
                        <th class="py-1 px-2 text-left whitespace-nowrap">H1</th>
                        <th class="py-1 px-2 text-left whitespace-nowrap">Word Count</th>
                        <th class="py-1 px-2 text-left whitespace-nowrap">Canonical Link</th>
                        <th class="py-1 px-2 text-left whitespace-nowrap">Status Code</th>
                        <th class="py-1 px-2 text-left whitespace-nowrap">Index/No Index</th>
                        <th class="py-1 px-2 text-left whitespace-nowrap">Last Modified</th>
                        <th class="py-1 px-2 text-left whitespace-nowrap">Inlinks</th>
                        <th class="py-1 px-2 text-left whitespace-nowrap">Outlinks</th>
                    </tr>
                </thead>
                <tbody class="text-gray-600 text-sm font-light">
                    {% for row in audit_data %}
                    <tr class="border-b border-gray-200 hover:bg-gray-100">
                        <td class="py-1 px-2 text-left whitespace-nowrap">
                            <!-- Actions dropdown -->
                            <select class="shadow border rounded w-32 py-1 px-2 text-gray-700 whitespace-nowrap">
                                <option value="Leave As Is" class="text-blue-500">1. Leave As Is</option>
                                <option value="Update On Page" class="text-green-500">2. Update "On Page"</option>
                                <option value="Target with Links" class="text-yellow-500">3. Target w/ Links</option>
                                <option value="301" class="text-red-500">4. 301</option>
                                <option value="Canonicalize" class="text-purple-500">5. Canonicalize</option>
                                <option value="Block Crawl" class="text-pink-500">6. Block Crawl</option>
                                <option value="No Index" class="text-indigo-500">7. No Index</option>
                                <option value="Content Audit" class="text-teal-500">8. Content Audit</option>
                                <option value="Merge" class="text-orange-500">9. Merge</option>
                            </select>
                        </td>
                        <td class="py-1 px-2 text-left whitespace-nowrap">{{ row.url }}</td>
                        <td class="py-1 px-2 text-left whitespace-nowrap">{{ row.final_url }}</td>
                        <td class="py-1 px-2 text-left whitespace-nowrap">{{ row.page_path }}</td>
                        <td class="py-1 px-2 text-left whitespace-nowrap">{{ row.category }}</td>
                        <td class="py-1 px-2 text-left whitespace-nowrap">{{ row.page_depth }}</td>
                        <td class="py-1 px-2 text-left whitespace-nowrap">
                            {% if row.in_sitemap == 'Yes' %}
                                <span class="text-green-500 font-semibold">{{ row.in_sitemap }}</span>
                            {% else %}
                                <span class="text-red-500 font-semibold">{{ row.in_sitemap }}</span>
                            {% endif %}
                        </td>

                        <!-- Keyword Performance -->
                        <td class="py-1 px-2 text-left whitespace-nowrap">{{ row.main_kw }}</td>
                        <td class="py-1 px-2 text-left whitespace-nowrap">{{ row.kw_volume }}</td>
                        <td class="py-1 px-2 text-left whitespace-nowrap">{{ row.kw_ranking }}</td>
                        <td class="py-1 px-2 text-left whitespace-nowrap">{{ row.best_kw }}</td>
                        <td class="py-1 px-2 text-left whitespace-nowrap">{{ row.best_kw_volume }}</td>
                        <td class="py-1 px-2 text-left whitespace-nowrap">{{ row.best_kw_ranking }}</td>

                        <!-- Page Performance -->
                        <td class="py-1 px-2 text-left whitespace-nowrap">{{ row.impressions }}</td>
                        <td class="py-1 px-2 text-left whitespace-nowrap">{{ row.sessions }}</td>
                        <td class="py-1 px-2 text-left whitespace-nowrap">{{ row.percent_change_sessions }}</td>
                        <td class="py-1 px-2 text-left whitespace-nowrap">{{ row.bounce_rate }}</td>
                        <td class="py-1 px-2 text-left whitespace-nowrap">{{ row.avg_time_on_page }}</td>
                        <td class="py-1 px-2 text-left whitespace-nowrap">{{ row.losing_traffic }}</td>
                        <td class="py-1 px-2 text-left whitespace-nowrap">{{ row.links }}</td>
                        <td class="py-1 px-2 text-left whitespace-nowrap">{{ row.serp_ctr }}</td>

                        <!-- Screaming Frog On-Page -->
                        <td class="py-1 px-2 text-left whitespace-nowrap">{{ row.type }}</td>
                        <td class="py-1 px-2 text-left whitespace-nowrap">{{ row.current_title }}</td>
                        <td class="py-1 px-2 text-left whitespace-nowrap">{{ row.meta }}</td>
                        <td class="py-1 px-2 text-left whitespace-nowrap">{{ row.h1 }}</td>
                        <td class="py-1 px-2 text-left whitespace-nowrap">{{ row.word_count }}</td>
                        <td class="py-1 px-2 text-left whitespace-nowrap"><a href="{{ row.canonical_link }}" target="_blank">{{ row.canonical_link }}</a></td>
                        <td class="py-1 px-2 text-left whitespace-nowrap">{{ row.status_code }}</td>
                        <td class="py-1 px-2 text-left whitespace-nowrap">{{ row.index_status }}</td>
                        <td class="py-1 px-2 text-left whitespace-nowrap">{{ row.last_modified }}</td>
                        <td class="py-1 px-2 text-left whitespace-nowrap">{{ row.inlinks|default:"0" }}</td> <!-- Default to 0 if empty -->
                        <td class="py-1 px-2 text-left whitespace-nowrap">{{ row.outlinks }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
</div>
{% endblock %}

<style>
    select {
        background-color: white;
        color: inherit;
    }
    select option {
        color: inherit;
    }
    select option[value="Leave As Is"] {
        color: blue;
    }
    select option[value="Update On Page"] {
        color: green;
    }
    select option[value="Target with Links"] {
        color: yellow;
    }
    select option[value="301"] {
        color: red;
    }
    select option[value="Canonicalize"] {
        color: purple;
    }
    select option[value="Block Crawl"] {
        color: pink;
    }
    select option[value="No Index"] {
        color: indigo;
    }
    select option[value="Content Audit"] {
        color: teal;
    }
    select option[value="Merge"] {
        color: orange;
    }
</style>